x = sym("x","real");
y = sym("y","real");
z = sym("z","real");
var_vec = [x.^3,x.^2.*y,x.^2.*z,x.*y.^2,...
    x.*y.*z,x.*z.^2,y.^3,y.^2.*z,y.*z.^2,z.^3,x.^2,x.*y,x.*z,y.^2,y.*z,z.^2,x,y,z,1]';
%%
c  = [...
    5,	0,	-4,	0,	0,	0,	-1,	0,	0,	0,	0,	-1,	5,	0,	0,	0,	2,	2,	3,	-3;...
    -3,	2,	1,	0,	0,	0,	0,	-1,	0,	0,	0,	4,	-4,	0,	0,	0,	1,	-4,	-4,	4;...
    -1,	1,	-4,	0,	0,	0,	0,	0,	-1,	0,	0,	-2,	-4,	0,	0,	0,	-3,	-4,	-2,	2;...
    4,	2,	4,	0,	0,	0,	0,	0,	0,	-1,	0,	1,	-4,	0,	0,	0,	3,	-3,	-2,	3;...
        ];
E4C3(c,plot_subspace=0,plot_surf=1);
latex(c*var_vec)
%%
c = [...
    -4,	3,	5,	0,	0,	0,	-1,	0,	0,	0,	0,	5,	-3,	0,	0,	0,	-2,	-2,	0,	0;...
    1,	4,	-4,	0,	0,	0,	0,	-1,	0,	0,	0,	2,	-2,	0,	0,	0,	5,	0,	0,	5;...
    0,	1,	3,	0,	0,	0,	0,	0,	-1,	0,	0,	-1,	-1,	0,	0,	0,	0,	4,	5,	0;...
    1,	-4,	-3,	0,	0,	0,	0,	0,	0,	-1,	0,	4,	0,	0,	0,	0,	5,	5,	0,	-3;...
    ];
E4C3(c,plot_subspace=0);
latex(c*var_vec)
%%
rng(0)
while true
% c = random_equations4C3(3);
c = randi(10,4,20);
r = E4C3(c,plot_subspace=0,plot_surf=0,error=0);
if ~isempty(r)
    break
end
end
r = E4C3(c,plot_subspace=0,plot_surf=1);